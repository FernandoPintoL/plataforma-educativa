@startuml
!theme plain

entity clientes {
  *id : bigserial NOT NULL,
  --
  razon_social : character varying(255) COLLATE pg
  nit : character varying(255) COLLATE pg
  telefono : character varying(255) COLLATE pg
  email : character varying(255) COLLATE pg
  activo : boolean NOT NULL DEFAULT true,
  foto_perfil : character varying(255) COLLATE pg
  ci_anverso : character varying(255) COLLATE pg
  ci_reverso : character varying(255) COLLATE pg
  limite_credito : numeric(18, 2) NOT NULL DEFAULT
  user_id : bigint,
  longitud : numeric(11, 8),
  codigo_cliente : character varying(20) COLLATE pg
}

entity direcciones_cliente {
  *id : bigserial NOT NULL,
  --
  direccion : character varying(255) COLLATE pg
  latitud : double precision,
  es_principal : boolean NOT NULL DEFAULT false,
  created_at : timestamp(0) without time zone,
  ciudad : character varying(255) COLLATE pg
  departamento : character varying(255) COLLATE pg
  codigo_postal : character varying(20) COLLATE pg
  observaciones : text COLLATE pg
}

entity fotos_lugar_cliente {
  *id : bigserial NOT NULL,
  --
  direccion_cliente_id : bigint,
  descripcion : character varying(255) COLLATE pg
  fecha_captura : timestamp(0) without time zone NOT NULL DEFAULT CURRENT
}

entity localidades {
  *id : bigserial NOT NULL,
  --
  codigo : character varying(10) COLLATE pg
  activo : boolean NOT NULL DEFAULT true,
  updated_at : timestamp(0) without time zone,
}

entity proveedores {
  *id : bigserial NOT NULL,
  --
  razon_social : character varying(255) COLLATE pg
  nit : character varying(255) COLLATE pg
  telefono : character varying(255) COLLATE pg
  email : character varying(255) COLLATE pg
  direccion : character varying(255) COLLATE pg
  contacto : character varying(255) COLLATE pg
  activo : boolean NOT NULL DEFAULT true,
  ci_anverso : character varying(255) COLLATE pg
  ci_reverso : character varying(255) COLLATE pg
  fecha_registro : timestamp(0) without time zone NOT NULL DEFAULT CURRENT
}

clientes }o--|| localidades : localidad_id -> id
direcciones_cliente }o--|| clientes : cliente_id -> id
fotos_lugar_cliente }o--|| clientes : cliente_id -> id
fotos_lugar_cliente }o--|| direcciones_cliente : direccion_cliente_id -> id

' Preferencias de entrega del cliente
entity ventanas_entrega_cliente {
  *id : bigserial NOT NULL,
  --
  cliente_id : bigint
  dia_semana : smallint  ' 0=Dom ... 6=Sáb
  hora_inicio : time
  hora_fin : time
  activo : boolean NOT NULL DEFAULT true,
  created_at : timestamp,
  updated_at : timestamp
}

' Categorías y relación con clientes
entity categorias_cliente {
  *id : bigserial NOT NULL,
  --
  clave : character varying(50) UNIQUE
  nombre : character varying(255)
  descripcion : character varying(255)
  activo : boolean NOT NULL DEFAULT true,
  created_at : timestamp,
  updated_at : timestamp
}

entity categoria_cliente {
  *id : bigserial NOT NULL,
  --
  cliente_id : bigint
  categoria_cliente_id : bigint
  created_at : timestamp,
  updated_at : timestamp
}

ventanas_entrega_cliente }o--|| clientes : cliente_id -> id
categoria_cliente }o--|| clientes : cliente_id -> id
categoria_cliente }o--|| categorias_cliente : categoria_cliente_id -> id
@enduml
