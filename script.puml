@startuml

' Configuraci√≥n de estilo
skinparam classAttributeIconSize 0
skinparam classFontSize 12
skinparam classBackgroundColor #F5F5F5
skinparam classBorderColor #666666
skinparam arrowColor #333333

entity "cache" as cache {
  value : text COLLATE pg_catalog
  expiration : integer NOT NULL?
}

entity "cache_locks" as cache_locks {
  owner : character varying(255) COLLATE pg_catalog
  expiration : integer NOT NULL?
}

entity "calificaciones" as calificaciones {
  # trabajo_id : bigint NOT NULL <<FK>>
  # evaluador_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  puntaje : double precision NOT NULL?
  comentario : text COLLATE pg_catalog?
  fecha_calificacion : timestamp(0) without time zone NOT NULL?
  criterios_evaluacion : json?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "carreras" as carreras {
  id : bigserial NOT NULL?
  nombre : character varying(255) COLLATE pg_catalog
  descripcion : text COLLATE pg_catalog
  nivel_educativo : character varying(255) COLLATE pg_catalog
  duracion_anos : double precision NOT NULL?
  areas_conocimiento : json NOT NULL?
  perfil_ideal : json NOT NULL?
  oportunidades_laborales : json NOT NULL?
  activo : boolean NOT NULL DEFAULT true?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "categorias_test" as categorias_test {
  # test_vocacional_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  nombre : character varying(255) COLLATE pg_catalog
  descripcion : text COLLATE pg_catalog?
  orden : integer NOT NULL DEFAULT 0?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "contenido_recurso" as contenido_recurso {
  # contenido_id : bigint NOT NULL <<FK>>
  # recurso_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "contenidos" as contenidos {
  # creador_id : bigint NOT NULL <<FK>>
  # curso_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  titulo : character varying(255) COLLATE pg_catalog
  descripcion : text COLLATE pg_catalog?
  fecha_creacion : date NOT NULL?
  fecha_limite : date?
  tipo : character varying(255) COLLATE pg_catalog
  estado : character varying(255) COLLATE pg_catalog
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "curso_estudiante" as curso_estudiante {
  # curso_id : bigint NOT NULL <<FK>>
  # estudiante_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  fecha_inscripcion : date NOT NULL?
  estado : character varying(255) COLLATE pg_catalog
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "cursos" as cursos {
  # profesor_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  nombre : character varying(255) COLLATE pg_catalog
  descripcion : text COLLATE pg_catalog?
  codigo : character varying(255) COLLATE pg_catalog
  estado : character varying(255) COLLATE pg_catalog
  fecha_inicio : date?
  fecha_fin : date?
  capacidad_maxima : integer?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "evaluaciones" as evaluaciones {
  # contenido_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  tipo_evaluacion : character varying(255) COLLATE pg_catalog
  puntuacion_total : integer NOT NULL DEFAULT 100?
  tiempo_limite : integer?
  calificacion_automatica : boolean NOT NULL DEFAULT false?
  mostrar_respuestas : boolean NOT NULL DEFAULT true?
  permite_reintento : boolean NOT NULL DEFAULT false?
  max_reintentos : integer NOT NULL DEFAULT 1?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "failed_jobs" as failed_jobs {
  id : bigserial NOT NULL?
  uuid : character varying(255) COLLATE pg_catalog
  connection : text COLLATE pg_catalog
  queue : text COLLATE pg_catalog
  payload : text COLLATE pg_catalog
  exception : text COLLATE pg_catalog
  failed_at : timestamp(0) without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP?
}

entity "job_batches" as job_batches {
  id : character varying(255) COLLATE pg_catalog
  name : character varying(255) COLLATE pg_catalog
  total_jobs : integer NOT NULL?
  pending_jobs : integer NOT NULL?
  failed_jobs : integer NOT NULL?
  failed_job_ids : text COLLATE pg_catalog
  options : text COLLATE pg_catalog?
  cancelled_at : integer?
  created_at : integer NOT NULL?
  finished_at : integer?
}

entity "jobs" as jobs {
  id : bigserial NOT NULL?
  queue : character varying(255) COLLATE pg_catalog
  payload : text COLLATE pg_catalog
  attempts : smallint NOT NULL?
  reserved_at : integer?
  available_at : integer NOT NULL?
  created_at : integer NOT NULL?
}

entity "materiales_apoyo" as materiales_apoyo {
  id : bigserial NOT NULL?
  titulo : character varying(255) COLLATE pg_catalog
  tipo : character varying(255) COLLATE pg_catalog
  url : character varying(255) COLLATE pg_catalog?
  descripcion : text COLLATE pg_catalog
  nivel_dificultad : integer NOT NULL DEFAULT 1?
  conceptos_relacionados : json NOT NULL?
  activo : boolean NOT NULL DEFAULT true?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "migrations" as migrations {
  id : serial NOT NULL?
  migration : character varying(255) COLLATE pg_catalog
  batch : integer NOT NULL?
}

entity "model_has_permissions" as model_has_permissions {
  # permission_id : bigint NOT NULL <<FK>>
  model_type : character varying(255) COLLATE pg_catalog
  model_id : bigint NOT NULL?
}

entity "model_has_roles" as model_has_roles {
  # role_id : bigint NOT NULL <<FK>>
  model_type : character varying(255) COLLATE pg_catalog
  model_id : bigint NOT NULL?
}

entity "modulos_sidebar" as modulos_sidebar {
  # modulo_padre_id : bigint <<FK>>
  id : bigserial NOT NULL?
  titulo : character varying(255) COLLATE pg_catalog
  ruta : character varying(255) COLLATE pg_catalog
  icono : character varying(255) COLLATE pg_catalog?
  descripcion : character varying(255) COLLATE pg_catalog?
  orden : integer NOT NULL DEFAULT 0?
  activo : boolean NOT NULL DEFAULT true?
  es_submenu : boolean NOT NULL DEFAULT false?
  permisos : json?
  color : character varying(255) COLLATE pg_catalog?
  categoria : character varying(255) COLLATE pg_catalog?
  visible_dashboard : boolean NOT NULL DEFAULT true?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "notificaciones" as notificaciones {
  # destinatario_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  titulo : character varying(255) COLLATE pg_catalog
  contenido : text COLLATE pg_catalog
  fecha : timestamp(0) without time zone NOT NULL?
  leido : boolean NOT NULL DEFAULT false?
  tipo : character varying(255) COLLATE pg_catalog
  datos_adicionales : json?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "password_reset_tokens" as password_reset_tokens {
  email : character varying(255) COLLATE pg_catalog
  token : character varying(255) COLLATE pg_catalog
  created_at : timestamp(0) without time zone?
}

entity "perfiles_vocacionales" as perfiles_vocacionales {
  # estudiante_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  intereses : json NOT NULL?
  habilidades : json NOT NULL?
  personalidad : json NOT NULL?
  aptitudes : json NOT NULL?
  fecha_creacion : timestamp(0) without time zone NOT NULL?
  fecha_actualizacion : timestamp(0) without time zone NOT NULL?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "permissions" as permissions {
  id : bigserial NOT NULL?
  name : character varying(255) COLLATE pg_catalog
  guard_name : character varying(255) COLLATE pg_catalog
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "preguntas" as preguntas {
  # evaluacion_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  enunciado : text COLLATE pg_catalog
  tipo : character varying(255) COLLATE pg_catalog
  opciones : json?
  respuesta_correcta : character varying(255) COLLATE pg_catalog?
  puntos : integer NOT NULL DEFAULT 1?
  orden : integer NOT NULL DEFAULT 0?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "preguntas_test" as preguntas_test {
  # categoria_test_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  enunciado : text COLLATE pg_catalog
  tipo : character varying(255) COLLATE pg_catalog
  opciones : json?
  orden : integer NOT NULL DEFAULT 0?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "recomendaciones_carrera" as recomendaciones_carrera {
  # estudiante_id : bigint NOT NULL <<FK>>
  # carrera_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  compatibilidad : double precision NOT NULL?
  justificacion : text COLLATE pg_catalog
  fecha : timestamp(0) without time zone NOT NULL?
  fuente : character varying(255) COLLATE pg_catalog
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "recomendaciones_material" as recomendaciones_material {
  # resultado_analisis_id : bigint NOT NULL <<FK>>
  # material_apoyo_id : bigint NOT NULL <<FK>>
  # estudiante_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  relevancia : double precision NOT NULL?
  asignado : boolean NOT NULL DEFAULT false?
  fecha_asignacion : timestamp(0) without time zone?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "recursos" as recursos {
  id : bigserial NOT NULL?
  nombre : character varying(255) COLLATE pg_catalog
  tipo : character varying(255) COLLATE pg_catalog
  url : character varying(255) COLLATE pg_catalog?
  descripcion : text COLLATE pg_catalog?
  archivo_path : character varying(255) COLLATE pg_catalog?
  mime_type : character varying(255) COLLATE pg_catalog?
  activo : boolean NOT NULL DEFAULT true?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "rendimiento_academico" as rendimiento_academico {
  # estudiante_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  materias : json NOT NULL?
  promedio : double precision NOT NULL?
  fortalezas : json NOT NULL?
  debilidades : json NOT NULL?
  tendencia_temporal : character varying(255) COLLATE pg_catalog
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "respuestas_test" as respuestas_test {
  # estudiante_id : bigint NOT NULL <<FK>>
  # pregunta_test_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  respuesta_seleccionada : character varying(255) COLLATE pg_catalog
  tiempo : integer?
  fecha_respuesta : timestamp(0) without time zone NOT NULL?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "resultados_analisis" as resultados_analisis {
  # trabajo_id : bigint NOT NULL <<FK>>
  # sistema_analisis_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  areas_fortaleza : json NOT NULL?
  areas_debilidad : json NOT NULL?
  confianza_predictiva : double precision NOT NULL?
  recomendaciones : json NOT NULL?
  metadatos : json?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "role_has_permissions" as role_has_permissions {
  # permission_id : bigint NOT NULL <<FK>>
  # role_id : bigint NOT NULL <<FK>>
}

entity "roles" as roles {
  id : bigserial NOT NULL?
  name : character varying(255) COLLATE pg_catalog
  guard_name : character varying(255) COLLATE pg_catalog
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "sessions" as sessions {
  id : character varying(255) COLLATE pg_catalog
  user_id : bigint?
  ip_address : character varying(45) COLLATE pg_catalog?
  user_agent : text COLLATE pg_catalog?
  payload : text COLLATE pg_catalog
  last_activity : integer NOT NULL?
}

entity "sistemas_analisis" as sistemas_analisis {
  id : bigserial NOT NULL?
  nombre : character varying(255) COLLATE pg_catalog
  descripcion : text COLLATE pg_catalog?
  tipo_modelo : character varying(255) COLLATE pg_catalog
  parametros : json?
  ultimo_entrenamiento : timestamp(0) without time zone?
  activo : boolean NOT NULL DEFAULT true?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "tareas" as tareas {
  # contenido_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  instrucciones : text COLLATE pg_catalog
  puntuacion : integer NOT NULL DEFAULT 100?
  permite_archivos : boolean NOT NULL DEFAULT true?
  max_archivos : integer NOT NULL DEFAULT 5?
  tipo_archivo_permitido : character varying(255) COLLATE pg_catalog?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "tests_vocacionales" as tests_vocacionales {
  id : bigserial NOT NULL?
  nombre : character varying(255) COLLATE pg_catalog
  descripcion : text COLLATE pg_catalog?
  duracion_estimada : integer?
  activo : boolean NOT NULL DEFAULT true?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "trabajos" as trabajos {
  # contenido_id : bigint NOT NULL <<FK>>
  # estudiante_id : bigint NOT NULL <<FK>>
  id : bigserial NOT NULL?
  respuestas : json?
  comentarios : text COLLATE pg_catalog?
  estado : character varying(255) COLLATE pg_catalog
  fecha_entrega : timestamp(0) without time zone?
  fecha_inicio : timestamp(0) without time zone?
  tiempo_total : integer?
  intentos : integer NOT NULL DEFAULT 0?
  consultas_material : integer NOT NULL DEFAULT 0?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
}

entity "users" as users {
  id : bigserial NOT NULL?
  name : character varying(255) COLLATE pg_catalog
  usernick : character varying(255) COLLATE pg_catalog?
  email : character varying(255) COLLATE pg_catalog?
  email_verified_at : timestamp(0) without time zone?
  password : character varying(255) COLLATE pg_catalog
  remember_token : character varying(100) COLLATE pg_catalog?
  created_at : timestamp(0) without time zone?
  updated_at : timestamp(0) without time zone?
  apellido : character varying(255) COLLATE pg_catalog?
  fecha_nacimiento : date?
  telefono : character varying(255) COLLATE pg_catalog?
  direccion : text COLLATE pg_catalog?
  tipo_usuario : character varying(255) COLLATE pg_catalog
  activo : boolean NOT NULL DEFAULT true?
}

' Relaciones
calificaciones }o--|| users
calificaciones }o--|| trabajos
categorias_test }o--|| tests_vocacionales
contenido_recurso }o--|| contenidos
contenido_recurso }o--|| recursos
contenidos }o--|| users
contenidos }o--|| cursos
curso_estudiante }o--|| cursos
curso_estudiante }o--|| users
cursos }o--|| users
evaluaciones }o--|| contenidos
model_has_permissions }o--|| permissions
model_has_roles }o--|| roles
modulos_sidebar }o--|| modulos_sidebar
notificaciones }o--|| users
perfiles_vocacionales }o--|| users
preguntas }o--|| evaluaciones
preguntas_test }o--|| categorias_test
recomendaciones_carrera }o--|| carreras
recomendaciones_carrera }o--|| users
recomendaciones_material }o--|| users
recomendaciones_material }o--|| materiales_apoyo
recomendaciones_material }o--|| resultados_analisis
rendimiento_academico }o--|| users
respuestas_test }o--|| users
respuestas_test }o--|| preguntas_test
resultados_analisis }o--|| sistemas_analisis
resultados_analisis }o--|| trabajos
role_has_permissions }o--|| permissions
role_has_permissions }o--|| roles
tareas }o--|| contenidos
trabajos }o--|| contenidos
trabajos }o--|| users

@enduml